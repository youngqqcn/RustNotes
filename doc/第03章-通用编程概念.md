

## ç¬¬3ç«  å¸¸è§ç¼–ç¨‹æ¦‚å¿µ

### å˜é‡å’Œå¯å˜æ€§

åœ¨Rustä¸­å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„. å¦‚éœ€å¯å˜çš„å˜é‡, åœ¨å£°æ˜æ—¶è¦æŒ‡å®šä¸º`mut`.

```rust
let x = 666; // immutable
//x = 777; //é”™è¯¯, ä¸å¯ä¿®æ”¹ä¸å¯å˜å˜é‡çš„å€¼

let mut y = 666; // muttable
y = 777; //ok
```

### ä¸å¯å˜å˜é‡å’Œå¸¸é‡çš„åŒºåˆ«

- ä¸å…è®¸å¯¹å¸¸é‡ä½¿ç”¨`mut`
- ä½¿ç”¨ `const` å£°æ˜å¸¸é‡, è€Œä¸æ˜¯ `let`
- å£°æ˜å¸¸é‡æ—¶å¿…é¡»æ³¨æ˜ç±»å‹
- å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨äºä¸­å£°æ˜, åŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸ
- å¸¸é‡åªèƒ½è®¾ç½®ä¸ºå¸¸é‡è¡¨è¾¾å¼(å³ç¼–è¯‘æ—¶ç¡®å®šçš„ç»“æœ), æ‰€ä»¥ä¸èƒ½æ˜¯å‡½æ•°æˆ–å…¶ä»–åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºç»“æœçš„å€¼
- å¸¸é‡çš„ç”Ÿå‘½å‘¨æœŸå’Œç¨‹åºç”Ÿå‘½å‘¨æœŸä¸€æ ·

```rust
const MAX_POINTS: u32 = 100000;
```


### éšè—(Shadowing)

éšè—å’Œ`mut`çš„åŒºåˆ«:
- éšè—åˆ›å»ºçš„æ˜¯ä¸€ä¸ªå…¨æ–°çš„å˜é‡,å¯ä»¥ä½¿ç”¨æ–°çš„ç±»å‹
- å¯ä»¥å¤ç”¨ç›¸åŒçš„å˜é‡åç§°


```rust
fn main() {
    let x = 5;
    let x = x + 1;
    let x = x * 2;
    println!("The value of x is: {}", x); // 12

    let x = "x"; //éšè—
    // x = "hello";// error , xä»ç„¶æ˜¯ä¸å¯å˜çš„
}
```

### æ•°æ®ç±»å‹

Rustçš„æ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»: æ ‡é‡(scalar) å’Œ å¤åˆ(compound)

#### æ ‡é‡ç±»å‹

æ•´å‹

| æ•°å­—å­—é¢å€¼                  | ä¾‹å­          |
| --------------------------- | ------------- |
| Decimal (åè¿›åˆ¶)            | `98_222`      |
| Hex (åå…­è¿›åˆ¶)              | `0xff`        |
| Octal (å…«è¿›åˆ¶)              | `0o77`        |
| Binary (äºŒè¿›åˆ¶)             | `0b1111_0000` |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äºu8) | `b'A'`        |


```rust
let n = 120u8;
let n = 100000000; //é»˜è®¤æ˜¯ i32
let n: i64 = 100000000; 
let n = 100_000_000u32;
let n = b'a'; //97
let n = 0xFFu32; //255;
let n = 0o10; // 8
let n = 0b1111; // 15
```

>æ³¨æ„: åœ¨Rustä¸­, Debugæ¨¡å¼ä¸‹è‹¥å‘ç”Ÿæ•´å‹æº¢å‡º, ä¼šå¯¼è‡´panic. Releaseä¸ä¼šæ£€æµ‹æ•´å‹æº¢å‡º.


æµ®ç‚¹å‹

Rustæœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹: `f32` å’Œ `f64`, Rustä¸­é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`

```rust

let x = 5.50423; // é»˜è®¤æ˜¯ f64
let x: f32 = 9.1234; // f32

```

æ•°å€¼è¿ç®—

```rust
fn main() {
    // åŠ æ³•
    let sum = 5 + 10;

    // å‡æ³•
    let difference = 95.5 - 4.3;

    // ä¹˜æ³•
    let product = 4 * 30;

    // é™¤æ³•
    let quotient = 56.7 / 32.2;

    // å–ä½™
    let remainder = 43 % 5;
}
```


å¸ƒå°”ç±»å‹

Rustä¸­çš„å¸ƒå°”ç±»å‹: `bool`

```rust
let t = true;
let f: bool = false; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
```

å­—ç¬¦ç±»å‹

Rustä¸­çš„`char`å 4ä¸ªå­—èŠ‚, ä»£è¡¨äº†ä¸€ä¸ª Unicodeæ ‡é‡.
Unicode æ ‡é‡å€¼åŒ…å«ä» U+0000 åˆ° U+D7FF å’Œ U+E000 åˆ° U+10FFFF åœ¨å†…çš„å€¼ã€‚

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let ch = 'å›½';
    let jp = 'ã';
    let gs = 'âˆ®';
    let sum = 'âˆ‘'; 
    let ko = 'ã„¶'; 


    // ä½¿ç”¨emoji https://emojipedia.org/
    let football = 'âš½';
    let smail = 'ğŸ˜Š'; //emoji
    let laughing_crying = 'ğŸ˜‚'; //emoji
}
```



å¤åˆç±»å‹: å…ƒç»„(tuple) å’Œ æ•°ç»„(array)

å…ƒç»„ç±»å‹
å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚

```rust

let tup: (i32, f64, u8) = (500, 6.4, 1);
println("{}", tup.0);
println!("{}", tup.1);

```


æ•°ç»„ç±»å‹
æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒ, Rust ä¸­çš„æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„,ä¸€æ—¦å£°æ˜ï¼Œå®ƒä»¬çš„é•¿åº¦ä¸èƒ½å¢é•¿æˆ–ç¼©å°ã€‚

```rust
let a = [1, 2, 3, 4, 5];
let a: [i32; 5] = [1, 2, 3, 4, 5];
let a = [3; 5];//ç­‰æ•ˆäº [3, 3, 3, 3, 3]

println!("{}", a[0]);
// println!("{}", a[1000]); //ç¼–è¯‘é”™è¯¯!


let index = 10000;
println!("{}", a[index]); //ç¼–è¯‘é€šè¿‡, ä½†æ˜¯è¿è¡Œæ—¶panic


```


### å‡½æ•°

å› ä¸º Rust æ˜¯ä¸€é—¨åŸºäºè¡¨è¾¾å¼ï¼ˆexpression-basedï¼‰çš„è¯­è¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„ï¼ˆä¸åŒäºå…¶ä»–è¯­è¨€ï¼‰é‡è¦åŒºåˆ«ã€‚

è¯­å¥ä¸è¡¨è¾¾å¼çš„åŒºåˆ«:
- è¯­å¥(statements): æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼å¾—æŒ‡ä»¤
- è¡¨è¾¾å¼(expressions): è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼

```rust
fn plus_two(arg: u32) -> u32 {
    let tmp = arg + 1; //ä»¥åˆ†å·ç»“å°¾çš„æ˜¯,è¯­å¥
    arg += 1 //è¡¨è¾¾å¼, æ³¨æ„æ²¡æœ‰åˆ†å·
    // åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼
    // ä½¿ç”¨ return ä¹Ÿå¯ä»¥
}

fn main() {
    let a = 9; //è¯­å¥

    let b = plus_two(a); //å‡½æ•°è°ƒç”¨æ˜¯è¡¨è¾¾å¼ , let b = xxx; æ•´ä½“åˆ™æ˜¯è¯­å¥
}
```


### ä»£ç æ³¨é‡Š

å•è¡Œæ³¨é‡Š, å¤šè¡Œæ³¨é‡Š, æ–‡æ¡£æ³¨é‡Š
```rust
// æ³¨é‡Š
/* æ³¨é‡Š */

/// è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£æ³¨é‡Š
fn foo() {
}
```

### æ§åˆ¶æµ

#### `if` è¡¨è¾¾å¼

```rust

fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else {
        println!("other");
    }


    // ç±»ä¼¼å…¶ä»–C++ä¸­çš„ä¸‰ç›®è¿ç®—ç¬¦
    let condition = true;
    let number = if condition {
        5  //ç±»å‹å¿…é¡»ç›¸åŒ
    } else {
        6  //ç±»å‹å¿…é¡»ç›¸åŒ
        // "str"  // error!!
    };


    // ä½¿ç”¨ if let 
    if let a = 9 {
        println!("a = {}", 9);
    }
}

```

#### å¾ªç¯è¯­å¥, loop, while, for

åªæœ‰`loop` å¾ªç¯å¯ä»¥ä½¿ç”¨ `break` ä»å¾ªç¯ä¸­è¿”å›å€¼

```rust

fn main() {

    //æ— é™å¾ªç¯
    /*
    loop {
        println!("ok......");
    }
    */

    // ä»å¾ªç¯è¿”å›(å¯ä»¥å¸¦ä¸Šè¿”å›å€¼), è¿™ä¸€ç‚¹ä¸å…¶ä»–è¯­è¨€ä¸é€š
    let mut n = 0;
    let result = loop {
        n += 1;
        if n == 10{
            break n * 2;  // å°† n * 2 ä½œä¸ºå¾ªç¯çš„è¿”å›å€¼
        }
    };
    println!("result = {}", result);



    /*
    let mut n = 0;
    let result = while true {
        n += 1;
        if n == 10{
            // can only break with a value inside `loop` or breakable block
            break n * 2;   // ç¼–è¯‘é”™è¯¯
        } 
    }
    println!("result = {}", result);
    */

    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {}", result); 


    // for å¾ªç¯

    let mut sum = 0;
    for i in 0..100 {
        sum += i;
    }
    println!("sum = {}", sum);


    let a  = [1, 2, 3, 4, 5, 6];

    for it in a.iter() {
        //it æ˜¯(å¼•ç”¨)è¿­ä»£å™¨

        // println!("the value is {}", *it); //OK, æ‰‹åŠ¨è§£å¼•ç”¨
        println!("the value is {}", it); //ok, Rust ä¼šè‡ªåŠ¨è§£å¼•ç”¨
    }

}

```
